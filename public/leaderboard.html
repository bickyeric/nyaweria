<!DOCTYPE html>
<html>

<head>
  <title>Leaderboard | Nyaweria</title>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
</head>

<body>
  <div class="flex justify-center pt-50">
    <div
      class="w-full max-w-sm bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700">
      <div class="flex flex-col items-center py-5 text-white">
        Leaderboard
      </div>
      <div class="relative overflow-x-auto">
        <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
          <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
            <tr>
              <th scope="col" class="px-6 py-3">
                No
              </th>
              <th scope="col" class="px-6 py-3">
                Name
              </th>
              <th scope="col" class="px-6 py-3">
                Amount
              </th>
            </tr>
          </thead>
          <tbody id="leaderboard-table">
            <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 border-gray-200">
              <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                1
              </th>
              <td class="px-6 py-4">
                Donatur 1
              </td>
              <td class="px-6 py-4">
                900.000
              </td>
            </tr>
            <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 border-gray-200">
              <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                2
              </th>
              <td class="px-6 py-4">
                Donatur 2
              </td>
              <td class="px-6 py-4">
                450.000
              </td>
            </tr>
            <tr class="bg-white dark:bg-gray-800">
              <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                3
              </th>
              <td class="px-6 py-4">
                Donatur 3
              </td>
              <td class="px-6 py-4">
                1.000
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
  </div>

  <script type="text/javascript">

    var username = "{{index . "username"}}"
    var loc = window.location;

    var leaderboardTable = document.getElementById("leaderboard-table");

    function clearTable() {
      while (leaderboardTable.children.length > 0) {
        leaderboardTable.children.item(0).remove();
      }
    }

    function refreshData() {
      fetch(`http://${loc.host}/api/donate/summaries?username=${username}`, {})
                .then((response) => response.json())
                .then((response) => {
                  clearTable();
                  response.data.forEach((element, index) => {
                    var row = leaderboardTable.insertRow(-1);
                    var cell1 = row.insertCell(-1);
                    cell1.innerHTML = index+1;
                    cell1.classList.add("px-6","py-4","font-medium","text-gray-900","whitespace-nowrap","dark:text-white")

                    var cell2 = row.insertCell(-1);
                    cell2.innerHTML = element.sender;
                    cell2.classList.add("px-6","py-4")

                    var cell3 = row.insertCell(-1);
                    cell3.innerHTML = element.sum;
                    cell3.classList.add("px-6","py-4")
                  });
                });

      setTimeout(refreshData, 5000)
    }

    refreshData()
  </script>
</body>

</html>
